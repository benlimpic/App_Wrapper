<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Profile</title>
    <link rel="stylesheet" th:href="@{/css/output.css}" />
    <script th:src="@{/js/accountDetails.js}" defer></script>
    <script th:src="@{/js/toggleProfilePhoto.js}" defer></script>
    <script th:src="@{/js/fadeAnimations.js}" defer></script>
    <script th:src="@{/js/updateChanges.js}" defer></script>
  </head>
  <body>
    <header>
      <nav class="navbar">
        <ul class="flex justify-between w-full">
          <li>
            <a href="/profile">
              <span>&#8592;</span>
            </a>
          </li>
        </ul>
      </nav>
    </header>
    <div class="profileContainer">
      <div class="h-auto w-full">
      <!-- USER DETAILS -->
      <div class="card">
        <h1 id="accountDetailsHeader" class="formHeader">Account Details</h1>
        <div class="errorBox">
          <div th:if="${message}" th:text="${message}" style="color: green;"></div>
          <div th:if="${error}" th:text="${error}" style="color: red;"></div>
        </div>
        
        <!-- UPDATE USERNAME FORM-->
        <div class="flex flex-col items-center justify-center w-full">
          <button class="deleteButton bg-slate-400 hover:bg-slate-400 w-2/3 px-4" id="updateUsernameButton">Update Username</button>
          <form class="hidden" id="updateUsernameForm" th:action="@{/update_username}" method="post" >
            <div class="flex flex-col items-center w-full pb-2">
            <label class="text-sm font-bold text-slate-600" for="username">New Username</label>
            <input class="input sm:text-sm" type="text" id="username" name="username" placeholder="New Username" required>
          </div>
          <div class="flex flex-row justify-center items-center">
            <button
            id="cancelUpdateUsernameButton"
            type="button"
            class="cancelButton"
            >Cancel</button>
            <button class="submitButton" type="submit">Update Username</button>
          </div>
        </form>
      </div>

        <!-- UPDATE EMAIL FORM-->
        <div class="flex flex-col items-center justify-center w-full">
          <button class="deleteButton bg-slate-400 hover:bg-slate-400 w-2/3 px-4" id="updateEmailButton">Update Email</button>
          <form id="updateEmailForm" class="hidden" th:action="@{/update_email}" method="post">
            <div class="flex flex-col items-center w-full pb-2">
            <label class="text-sm font-bold text-slate-600" for="newEmail">New Email</label>
            <input class="input sm:text-sm" type="email" id="newEmail" name="newEmail" placeholder="New Email" required>
            <label class="text-sm font-bold text-slate-600"  for="confirmNewEmail">Confirm New Email</label>
            <input class="input sm:text-sm" type="email" id="confirmNewEmail" name="confirmNewEmail" placeholder="Confirm New Email" required>
          </div>
          <div class="flex flex-row justify-center items-center">
            <button
            id="cancelUpdateEmailButton"
            type="button"
            class="cancelButton"
            >Cancel</button>
            <button class="submitButton" type="submit">Update Email</button>
          </div>
        </form>
      </div>

        <!-- UPDATE PASSWORD FORM-->
        <div class="flex flex-col items-center justify-center w-full">
          <button class="deleteButton bg-slate-400 hover:bg-slate-400 w-2/3 px-4" id="updatePasswordButton">Update Password</button>
          <form class="hidden" id="updatePasswordForm" th:action="@{/update_password}" method="post">
          <div class="flex flex-col items-center w-full pb-4">
            <label class="text-sm font-bold text-slate-600" for="currentPassword">Current Password</label>
            <input class="input sm:text-sm" type="password" id="currentPassword" name="currentPassword" placeholder="Current Password" required>
            <label class="text-sm font-bold text-slate-600" for="newPassword">New Password</label>
            <input class="input sm:text-sm" type="password" id="newPassword" name="newPassword" placeholder="New Password" required>
            <label class="text-sm font-bold text-slate-600" for="confirmNewPassword">Confirm New Password</label>
            <input class="input sm:text-sm" type="password" id="confirmNewPassword" name="confirmNewPassword" placeholder="Confirm New Password" required>
          </div>   
          <div class="flex flex-row justify-center items-center">
            <button
            id="cancelUpdatePasswordButton"
            type="button"
            class="cancelButton"
            >Cancel</button>
            <button class="submitButton" type="submit">Update Password</button>
          </div>
        </form>
      </div>

        <!-- DELETE USER FORM -->
        <div class="flex flex-col items-center justify-center w-full">
          <button class="deleteButton bg-slate-400 hover:bg-slate-400 w-2/3 px-4" id="deleteAccountButton">Delete Account</button>
          <form class="hidden" id="deleteAccountForm" th:action="@{/delete_user}" method="post" >
            <input type="hidden" name="_csrf" th:value="${_csrf.token}" />
            <input type="hidden" name="username" th:value="${user != null ? user.username : ''}" />
            <div class="flex flex-col items-center w-full pb-2">

              <label id="confirmDeleteLabel" for="confirmDelete" class="text-sm font-bold text-red-600">
                Confirm Account Delete
              </label>
              <input
              type="text"
              id="confirmDelete"
              name="confirmDelete"
              placeholder="DELETE"
              required
              class="input focus:border-red-500 focus:ring-red-500 sm:text-sm invalid:border-red-500 invalid:ring-red-500"
              />
              </div>
              <div class="flex flex-row justify-center items-center">
                <button
                id="cancelDeleteButton"
                type="button"
                class="cancelButton"
                >Cancel</button>
                <button
                type="submit" class="deleteButton focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2">
                Delete
              </button>
            </div>
          </div>            
          </form>
        </div>

      </div>
    </div>
    </div>
  </body>
</html>
